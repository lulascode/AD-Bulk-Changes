<Window x:Class="AD_BulkChanges.AdvancedMappingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Erweiterte Filter-Bedingungen" Height="650" Width="700"
        WindowStartupLocation="CenterOwner" ResizeMode="NoResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Erklärung -->
        <Border Grid.Row="0" Background="#E3F2FD" Padding="10" CornerRadius="5" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock TextWrapping="Wrap" FontWeight="Bold" FontSize="12">
                    Erweiterte Regel-Definition mit mehreren Bedingungen (UND/ODER)
                </TextBlock>
                <TextBlock TextWrapping="Wrap" FontSize="11" Margin="0,5,0,0">
                    Beispiel: Ändere Position auf "GF" UND Abteilung auf "Management" wenn Titel = "Geschäftsführer" ODER Description = "CEO"
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Ziel-Felder -->
        <GroupBox Grid.Row="1" Header="Was soll geändert werden? (Mehrfach-Auswahl möglich)" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Ziel-Feld hinzufügen -->
                <Grid Grid.Row="0" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <ComboBox Name="CmbTargetField" Grid.Column="0" Margin="0,0,5,0">
                        <ComboBoxItem Content="Position (Title)" IsSelected="True"/>
                        <ComboBoxItem Content="Abteilung (Department)"/>
                        <ComboBoxItem Content="Beschreibung (Description)"/>
                    </ComboBox>
                    
                    <TextBox Name="TxtTargetValue" Grid.Column="1" Margin="5,0,5,0" 
                             VerticalContentAlignment="Center"/>
                    
                    <Button Name="BtnAddTarget" Content="+ Ziel" Grid.Column="2" 
                            Click="BtnAddTarget_Click" Background="#FF2196F3" Foreground="White" Padding="10,5"/>
                </Grid>

                <!-- Liste der Ziel-Felder -->
                <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="5,10,5,5" MinHeight="60" MaxHeight="80">
                    <ScrollViewer>
                        <StackPanel Name="PnlTargets" Margin="5">
                            <TextBlock Text="Keine Ziel-Felder hinzugefügt" Foreground="Gray" 
                                       Name="TxtNoTargets" FontStyle="Italic"/>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </GroupBox>

        <!-- Filter-Bedingungen -->
        <GroupBox Grid.Row="2" Header="Filter-Bedingungen (UND-Verknüpfung)">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Bedingung hinzufügen -->
                <Grid Grid.Row="0" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <ComboBox Name="CmbLogicOperator" Grid.Column="0" Width="70" Margin="0,0,5,0">
                        <ComboBoxItem Content="UND" IsSelected="True"/>
                        <ComboBoxItem Content="ODER"/>
                    </ComboBox>
                    
                    <ComboBox Name="CmbConditionField" Grid.Column="1" Margin="0,0,5,0">
                        <ComboBoxItem Content="Position (Title)" IsSelected="True"/>
                        <ComboBoxItem Content="Abteilung (Department)"/>
                        <ComboBoxItem Content="Beschreibung (Description)"/>
                        <ComboBoxItem Content="E-Mail (Email)"/>
                        <ComboBoxItem Content="Anzeigename (DisplayName)"/>
                        <ComboBoxItem Content="Benutzername (SamAccountName)"/>
                    </ComboBox>
                    
                    <ComboBox Name="CmbConditionValue" Grid.Column="2" Margin="0,0,5,0" 
                              IsEditable="True" ItemsSource="{Binding}"/>
                    
                    <Button Name="BtnAddCondition" Content="+ Bedingung" Grid.Column="3" 
                            Click="BtnAddCondition_Click" Background="#FF4CAF50" Foreground="White" Padding="10,5"/>
                </Grid>

                <!-- Liste der Bedingungen -->
                <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="5,10,5,5" MinHeight="100">
                    <ScrollViewer>
                        <StackPanel Name="PnlConditions" Margin="5">
                            <TextBlock Text="Keine Bedingungen hinzugefügt (max. 4)" Foreground="Gray" 
                                       Name="TxtNoConditions" FontStyle="Italic"/>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </GroupBox>

        <!-- Vorschau -->
        <Border Grid.Row="3" Background="#FFF3E5" Padding="10" CornerRadius="5" Margin="0,10,0,10">
            <StackPanel>
                <TextBlock FontWeight="Bold" Text="Regel-Vorschau:"/>
                <TextBlock Name="TxtPreview" FontFamily="Consolas" FontSize="11" Margin="0,5,0,0" TextWrapping="Wrap">
                    Wenn (keine Bedingungen) → ''
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Name="BtnOK" Content="OK" Click="BtnOK_Click" 
                    Width="100" Background="#FF4CAF50" Foreground="White" Margin="0,0,10,0" IsEnabled="False"/>
            <Button Name="BtnCancel" Content="Abbrechen" Click="BtnCancel_Click" Width="100"/>
        </StackPanel>
    </Grid>
</Window>
